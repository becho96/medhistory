# ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ Production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –∑–∞–≤–µ—Ä—à–µ–Ω–∞!

–ü—Ä–æ–µ–∫—Ç MedHistory —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤ –æ–±–ª–∞–∫–µ –Ø–Ω–¥–µ–∫—Å.

## üì¶ –ß—Ç–æ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ

### 1. Production –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker

#### `docker-compose.prod.yml`
Production –≤–µ—Ä—Å–∏—è Docker Compose —Å:
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è production
- Nginx reverse proxy —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π SSL
- Health checks –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ª–æ–≥–æ–≤
- Restart policies
- –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–µ—Ç—å—é –±–µ–∑ –ø—É–±–ª–∏—á–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤ –ë–î

#### `backend/Dockerfile.prod`
Production Dockerfile –¥–ª—è backend:
- Multi-stage build –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- 4 Uvicorn workers –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏
- Non-root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- Health checks
- –ë–µ–∑ hot reload (—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å)

#### `frontend/Dockerfile.prod`
Production Dockerfile –¥–ª—è frontend:
- Multi-stage build (builder + nginx)
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ (–æ—Ç ~1GB –¥–æ ~50MB)
- Nginx –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏ —Å gzip —Å–∂–∞—Ç–∏–µ–º
- Security headers
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤

### 2. Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### `nginx/nginx.conf`
–ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è reverse proxy:
- HTTP ‚Üí HTTPS —Ä–µ–¥–∏—Ä–µ–∫—Ç (–≥–æ—Ç–æ–≤–æ –∫ –≤–∫–ª—é—á–µ–Ω–∏—é)
- Rate limiting (–∑–∞—â–∏—Ç–∞ –æ—Ç DDoS)
- Gzip —Å–∂–∞—Ç–∏–µ
- –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ API –∏ frontend
- –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
- CORS headers
- Security headers
- Health check endpoint
- –ì–æ—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏ –¥–ª—è SSL (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã)

#### `frontend/nginx.conf`
Nginx –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏ frontend:
- SPA routing (history mode)
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- Gzip —Å–∂–∞—Ç–∏–µ
- Security headers

### 3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### `.env.production` (—à–∞–±–ª–æ–Ω —Å–æ–∑–¥–∞–Ω)
–®–∞–±–ª–æ–Ω –¥–ª—è production –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è –ë–î
- JWT —Å–µ–∫—Ä–µ—Ç—ã
- MinIO credentials
- OpenRouter API key
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Yandex Managed Services
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –ø—Ä–∏–º–µ—Ä—ã

### 4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

#### `DEPLOYMENT.md` (46 KB, ~900 —Å—Ç—Ä–æ–∫)
–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é:
- **–í–∞—Ä–∏–∞–Ω—Ç 1:** –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ –í–ú (–≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ)
  - –°–æ–∑–¥–∞–Ω–∏–µ –í–ú —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å –∏ CLI
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥—Ä—É–ø–ø –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
  - –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- **–í–∞—Ä–∏–∞–Ω—Ç 2:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Managed Services
  - Managed PostgreSQL
  - Managed MongoDB
  - Object Storage (S3)
  - Certificate Manager
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL (Let's Encrypt + Certbot)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
- –ë—ç–∫–∞–ø—ã –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ)
- –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ (~3,500‚ÇΩ/–º–µ—Å)

#### `QUICKSTART_PRODUCTION.md`
–ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –Ω–∞ 10 –º–∏–Ω—É—Ç:
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —à–∞–≥–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–µ–ø–ª–æ—è
- Checklist –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL –∑–∞ 5 –º–∏–Ω—É—Ç
- –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### 5. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (Scripts)

–í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `scripts/`:

#### `setup-server.sh`
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞:
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –∏ Docker Compose
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ firewall (UFW)
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ fail2ban
- –°–æ–∑–¥–∞–Ω–∏–µ swap
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ timezone
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —É—Ç–∏–ª–∏—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

#### `deploy.sh`
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ production:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É
- –í–∞–ª–∏–¥–∞—Ü–∏—è .env.production
- –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏
- –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
- –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –Ω–æ–≤—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤

#### `backup.sh`
–ü–æ–ª–Ω—ã–π –±—ç–∫–∞–ø –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö:
- PostgreSQL dump
- MongoDB dump
- MinIO files backup
- –°–æ–∑–¥–∞–Ω–∏–µ tar.gz –∞—Ä—Ö–∏–≤–∞
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑–º–µ—Ä–µ
- –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º

#### `restore.sh`
–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞:
- –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∞—Ä—Ö–∏–≤–∞
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ PostgreSQL
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ MongoDB
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ MinIO
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö

#### `logs.sh`
–£–¥–æ–±–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
- –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ dev/prod –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–µ—Ä–≤–∏—Å–∞–º
- Follow —Ä–µ–∂–∏–º
- –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥

#### `status.sh`
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã:
- –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- Health checks
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU/RAM/Disk
- –†–∞–∑–º–µ—Ä—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—à–∏–±–∫–∏ –∏–∑ –ª–æ–≥–æ–≤
- –ö—Ä–∞—Å–∏–≤—ã–π —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥

### 6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã

#### `.dockerignore`
–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–æ–≤:
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ node_modules
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ .git
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –∏ –±—ç–∫–∞–ø–æ–≤
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

#### `.gitignore`
–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —á–∏—Å—Ç–æ—Ç–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:
- –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ .env —Ñ–∞–π–ª–æ–≤
- –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ node_modules
- –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ __pycache__
- –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ uploads
- –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤

## üöÄ –ö–∞–∫ –Ω–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ production —Å–±–æ—Ä–∫–∏

```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ .env.production (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å dev –∑–Ω–∞—á–µ–Ω–∏—è)
cp .env .env.production

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ production –≤–µ—Ä—Å–∏—é –ª–æ–∫–∞–ª—å–Ω–æ
docker compose -f docker-compose.prod.yml --env-file .env.production up -d

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É
./scripts/status.sh

# 4. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
./scripts/logs.sh -f

# 5. –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker compose -f docker-compose.prod.yml down
```

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ –Ø–Ω–¥–µ–∫—Å.–û–±–ª–∞–∫–µ

#### –ë—ã—Å—Ç—Ä—ã–π –ø—É—Ç—å (10 –º–∏–Ω—É—Ç):
```bash
# –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
cat QUICKSTART_PRODUCTION.md
```

#### –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ:
```bash
# –ß–∏—Ç–∞–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
cat DEPLOYMENT.md
```

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π:
```bash
# 1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä
ssh ubuntu@<IP> < scripts/setup-server.sh

# 2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env.production —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π
./scripts/deploy.sh <server_ip> ubuntu
```

## üìã Checklist –ø–µ—Ä–µ–¥ production –¥–µ–ø–ª–æ–µ–º

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:
- [ ] –°–æ–∑–¥–∞–Ω –∞–∫–∫–∞—É–Ω—Ç –≤ –Ø–Ω–¥–µ–∫—Å.–û–±–ª–∞–∫–µ —Å –ø–æ–ø–æ–ª–Ω–µ–Ω–Ω—ã–º –±–∞–ª–∞–Ω—Å–æ–º
- [ ] –ü–æ–ª—É—á–µ–Ω OpenRouter API –∫–ª—é—á (~$10 –Ω–∞ –±–∞–ª–∞–Ω—Å–µ)
- [ ] –°–æ–∑–¥–∞–Ω–∞ –í–ú –≤ Compute Cloud (4 vCPU, 8GB RAM, 50GB SSD)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –≥—Ä—É–ø–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–ø–æ—Ä—Ç—ã 22, 80, 443)
- [ ] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `.env.production` —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏
- [ ] –ò–∑–º–µ–Ω–µ–Ω—ã –í–°–ï –ø–∞—Ä–æ–ª–∏ –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ (16+ —Å–∏–º–≤–æ–ª–æ–≤)
- [ ] –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω JWT_SECRET (`openssl rand -hex 32`)
- [ ] –£–∫–∞–∑–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π VITE_API_URL (IP –∏–ª–∏ –¥–æ–º–µ–Ω)

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
- [ ] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Let's Encrypt)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã (cron)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–Ø–Ω–¥–µ–∫—Å.–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–ª–µ—Ä—Ç—ã (CPU, RAM, Disk)
- [ ] –°–æ–∑–¥–∞–Ω—ã SSH –∫–ª—é—á–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- [ ] –ò–∑–º–µ–Ω–µ–Ω SSH –ø–æ—Ä—Ç —Å 22 –Ω–∞ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω fail2ban –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞

```
–ò—Å—Ç–æ—Ä–∏—è –±–æ–ª–µ–∑–Ω–∏/
‚îú‚îÄ‚îÄ üìÑ docker-compose.yml              # Development
‚îú‚îÄ‚îÄ üìÑ docker-compose.prod.yml         # Production (–ù–û–í–´–ô)
‚îú‚îÄ‚îÄ üìÑ .env                             # Development –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ üìÑ .env.production                  # Production –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–ù–û–í–´–ô)
‚îú‚îÄ‚îÄ üìÑ .dockerignore                    # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏ (–ù–û–í–´–ô)
‚îú‚îÄ‚îÄ üìÑ .gitignore                       # Git ignore (–û–ë–ù–û–í–õ–ï–ù)
‚îÇ
‚îú‚îÄ‚îÄ üìö DEPLOYMENT.md                    # –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ (–ù–û–í–´–ô)
‚îú‚îÄ‚îÄ üìö QUICKSTART_PRODUCTION.md         # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (–ù–û–í–´–ô)
‚îú‚îÄ‚îÄ üìö PRODUCTION_SETUP_COMPLETE.md     # –≠—Ç–æ—Ç —Ñ–∞–π–ª (–ù–û–í–´–ô)
‚îú‚îÄ‚îÄ üìö README.md                        # –ì–ª–∞–≤–Ω—ã–π README (–û–ë–ù–û–í–õ–ï–ù)
‚îÇ
‚îú‚îÄ‚îÄ üìÅ backend/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile                      # Development
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile.prod                 # Production (–ù–û–í–´–ô)
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ üìÅ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile                      # Development
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile.prod                 # Production (–ù–û–í–´–ô)
‚îÇ   ‚îú‚îÄ‚îÄ nginx.conf                      # –î–ª—è prod –æ–±—Ä–∞–∑–∞ (–ù–û–í–´–ô)
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ üìÅ nginx/                           # (–ù–û–í–ê–Ø –ü–ê–ü–ö–ê)
‚îÇ   ‚îú‚îÄ‚îÄ nginx.conf                      # Reverse proxy config
‚îÇ   ‚îú‚îÄ‚îÄ logs/                           # Nginx –ª–æ–≥–∏
‚îÇ   ‚îî‚îÄ‚îÄ ssl/                            # SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (—Å–æ–∑–¥–∞–π—Ç–µ)
‚îÇ
‚îî‚îÄ‚îÄ üìÅ scripts/                         # (–ù–û–í–ê–Ø –ü–ê–ü–ö–ê)
    ‚îú‚îÄ‚îÄ setup-server.sh                 # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
    ‚îú‚îÄ‚îÄ deploy.sh                       # –ê–≤—Ç–æ–¥–µ–ø–ª–æ–π
    ‚îú‚îÄ‚îÄ backup.sh                       # –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞
    ‚îú‚îÄ‚îÄ restore.sh                      # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
    ‚îú‚îÄ‚îÄ logs.sh                         # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
    ‚îî‚îÄ‚îÄ status.sh                       # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### Development (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
```bash
docker-compose up -d                    # –ó–∞–ø—É—Å–∫
docker-compose logs -f                  # –õ–æ–≥–∏
docker-compose down                     # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
```

### Production (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
```bash
# –ó–∞–ø—É—Å–∫
docker compose -f docker-compose.prod.yml --env-file .env.production up -d

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
./scripts/status.sh                     # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
./scripts/logs.sh backend -f            # –õ–æ–≥–∏ backend
./scripts/backup.sh ~/backups           # –ë—ç–∫–∞–ø
./scripts/restore.sh backup.tar.gz      # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
./scripts/deploy.sh <server_ip> ubuntu  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker compose -f docker-compose.prod.yml down
```

## üí∞ –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–í–∞—Ä–∏–∞–Ω—Ç 1)
- –í–ú 4 vCPU, 8GB: **~2,500‚ÇΩ/–º–µ—Å**
- –î–∏—Å–∫ 50GB SSD: **~500‚ÇΩ/–º–µ—Å**
- IP –∞–¥—Ä–µ—Å: **~150‚ÇΩ/–º–µ—Å**
- –¢—Ä–∞—Ñ–∏–∫ 100GB: **~200‚ÇΩ/–º–µ—Å**
- **–ò—Ç–æ–≥–æ: ~3,350‚ÇΩ/–º–µ—Å**

### –° Managed Services (–í–∞—Ä–∏–∞–Ω—Ç 2)
- Managed PostgreSQL: **~4,000‚ÇΩ/–º–µ—Å**
- Managed MongoDB: **~4,500‚ÇΩ/–º–µ—Å**
- Object Storage 100GB: **~200‚ÇΩ/–º–µ—Å**
- –í–ú 2 vCPU, 4GB: **~1,500‚ÇΩ/–º–µ—Å**
- Load Balancer: **~600‚ÇΩ/–º–µ—Å**
- **–ò—Ç–æ–≥–æ: ~10,800‚ÇΩ/–º–µ—Å**

### OpenRouter API (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ)
- –ü—Ä–∏ 100 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤/–º–µ—Å: **~400-800‚ÇΩ/–º–µ—Å**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–∞—á–Ω–∏—Ç–µ —Å –í–∞—Ä–∏–∞–Ω—Ç–∞ 1 (3,350‚ÇΩ/–º–µ—Å)

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß—Ç–æ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:
‚úÖ Non-root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö  
‚úÖ Rate limiting –≤ Nginx  
‚úÖ Security headers  
‚úÖ CORS –ø–æ–ª–∏—Ç–∏–∫–∏  
‚úÖ Health checks  
‚úÖ –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è Docker —Å–µ—Ç—å  
‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–æ—Ç–∞—Ü–∏–µ–π  

### –ß—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:
‚ö†Ô∏è –ò–∑–º–µ–Ω–∏—Ç—å –≤—Å–µ –ø–∞—Ä–æ–ª–∏ –≤ .env.production  
‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL/HTTPS  
‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å firewall –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ  
‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å fail2ban  
‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã  
‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥  

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –≤–æ–ø—Ä–æ—Å—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- [DEPLOYMENT.md](./DEPLOYMENT.md) - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- [QUICKSTART_PRODUCTION.md](./QUICKSTART_PRODUCTION.md) - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- [README.md](./README.md) - –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `./scripts/status.sh`
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ `./scripts/logs.sh -f`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é `DEPLOYMENT.md`
4. –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

## ‚ú® –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ:**
   ```bash
   docker compose -f docker-compose.prod.yml up -d
   ./scripts/status.sh
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ –í–ú –≤ –Ø–Ω–¥–µ–∫—Å.–û–±–ª–∞–∫–µ:**
   - –°–ª–µ–¥—É–π—Ç–µ `QUICKSTART_PRODUCTION.md`

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   ./scripts/setup-server.sh
   ```

4. **–ó–∞–¥–µ–ø–ª–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```bash
   ./scripts/deploy.sh <server_ip> ubuntu
   ```

5. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSL:**
   - –°–ª–µ–¥—É–π—Ç–µ —Ä–∞–∑–¥–µ–ª—É "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL" –≤ `DEPLOYMENT.md`

6. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –Ø–Ω–¥–µ–∫—Å.–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
   - –ê–ª–µ—Ä—Ç—ã –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏

7. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±—ç–∫–∞–ø—ã:**
   ```bash
   crontab -e
   # 0 3 * * * cd ~/medhistory && ./scripts/backup.sh ~/backups
   ```

---

## üéâ –ì–æ—Ç–æ–≤–æ –∫ Production!

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –≤ –æ–±–ª–∞–∫–µ.  
–í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã.  
–°–ª–µ–¥—É–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –≤—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è!

**–£–¥–∞—á–∏ —Å –¥–µ–ø–ª–æ–µ–º! üöÄ**

---

**–î–∞—Ç–∞:** –û–∫—Ç—è–±—Ä—å 2024  
**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ –¥–ª—è:** –Ø–Ω–¥–µ–∫—Å.–û–±–ª–∞–∫–æ (Yandex Cloud)

