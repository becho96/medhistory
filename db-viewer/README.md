# DB Viewer

ะะตะฑ-ะธะฝัะตััะตะนั ะดะปั ะฟัะพัะผะพััะฐ ัะพะดะตัะถะธะผะพะณะพ PostgreSQL ะธ MongoDB ั ะฟะพะดะดะตัะถะบะพะน ะฟะตัะตะบะปััะตะฝะธั ะผะตะถะดั ะปะพะบะฐะปัะฝัะผ ะธ production ะพะบััะถะตะฝะธะตะผ.

## ะะพะทะผะพะถะฝะพััะธ

- ๐ **ะะตัะตะบะปััะตะฝะธะต ะพะบััะถะตะฝะธะน** โ Local / Production (Yandex Cloud)
- ๐ **PostgreSQL** โ ะฟัะพัะผะพัั ัะฐะฑะปะธั, ะบะพะปะพะฝะพะบ, ะดะฐะฝะฝัั
- ๐ **MongoDB** โ ะฟัะพัะผะพัั ะบะพะปะปะตะบัะธะน ะธ ะดะพะบัะผะตะฝัะพะฒ
- ๐ ะะพะปะธัะตััะฒะพ ะทะฐะฟะธัะตะน ะฒ ะบะฐะถะดะพะน ัะฐะฑะปะธัะต/ะบะพะปะปะตะบัะธะธ
- ๐ ะะฝัะพัะผะฐัะธั ะพ ััััะบัััะต (ะบะพะปะพะฝะบะธ, ัะธะฟั)
- ๐ ะัะพัะผะพัั ะดะฐะฝะฝัั ั ะฟะฐะณะธะฝะฐัะธะตะน
- ๐จ ะะพะดัะฒะตัะบะฐ ัะธะฟะพะฒ ะดะฐะฝะฝัั (UUID, ObjectId, ะดะฐัั, boolean)
- ๐ ะัะพัะผะพัั ะฒะปะพะถะตะฝะฝัั JSON ะพะฑัะตะบัะพะฒ

## ะัััััะน ะทะฐะฟััะบ

### 1. ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน

```bash
cd db-viewer
pip install -r requirements.txt
```

### 2. ะะฐะฟััะบ ะดะปั ะปะพะบะฐะปัะฝะพะน ัะฐะทัะฐะฑะพัะบะธ

ะฃะฑะตะดะธัะตัั, ััะพ ะปะพะบะฐะปัะฝัะน Docker ะทะฐะฟััะตะฝ:

```bash
cd ..
docker compose up -d
```

ะะฐะฟัััะธัะต DB Viewer:

```bash
cd db-viewer
python app.py
```

ะัะบัะพะนัะต ะฒ ะฑัะฐัะทะตัะต: http://localhost:5050

## ะะพะฝัะธะณััะฐัะธั

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

#### ะะพะบะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต (ะฟะพ ัะผะพะปัะฐะฝะธั)

```bash
# PostgreSQL
PG_HOST=localhost
PG_PORT=5432
PG_DB=medhistory
PG_USER=medhistory_user
PG_PASSWORD=medhistory_local_pass

# MongoDB
MONGO_HOST=localhost
MONGO_PORT=27017
MONGO_USER=admin
MONGO_PASSWORD=mongodb_secure_pass
MONGO_DB=medhistory
```

#### Production ะพะบััะถะตะฝะธะต (Yandex Cloud)

ะะปั ะฟะพะดะบะปััะตะฝะธั ะบ production ัะตัะฒะตัั ััะตะฑัะตััั SSH ััะฝะฝะตะปั:

```bash
# SSH ะดะพัััะฟ
PROD_SSH_HOST=93.77.182.26
PROD_SSH_PORT=22
PROD_SSH_USER=yc-user
PROD_SSH_KEY=~/.ssh/id_rsa

# PostgreSQL (ะฟะฐัะพะปะธ ั ัะตัะฒะตัะฐ)
PROD_PG_DB=medhistory
PROD_PG_USER=medhistory_user
PROD_PG_PASSWORD=<production_password>

# MongoDB
PROD_MONGO_DB=medhistory
PROD_MONGO_USER=admin
PROD_MONGO_PASSWORD=<production_password>
```

### ะะฐะฟััะบ ั ะฟะตัะตะผะตะฝะฝัะผะธ ะพะบััะถะตะฝะธั

```bash
# ะงะตัะตะท ัะบัะฟะพัั
export PROD_PG_PASSWORD=your_password
export PROD_MONGO_PASSWORD=your_password
python app.py

# ะะปะธ ัะตัะตะท dotenv ัะฐะนะป
# ะกะพะทะดะฐะนัะต ัะฐะนะป .env ะฒ ะดะธัะตะบัะพัะธะธ db-viewer ะธ ะดะพะฑะฐะฒััะต ะฟะตัะตะผะตะฝะฝัะต
```

## ะััะธัะตะบัััะฐ ะฟะพะดะบะปััะตะฝะธั ะบ Production

```
โโโโโโโโโโโโโโโโ     SSH Tunnel      โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              โ โโโโโโโโโโโโโโโโโโโโบโ   Yandex Cloud Server       โ
โ  DB Viewer   โ     Port 15432 โโโโโบโ   PostgreSQL (5432)         โ
โ  (localhost) โ     Port 17017 โโโโโบโ   MongoDB (27017)           โ
โ              โ                     โ   93.77.182.26            โ
โโโโโโโโโโโโโโโโ                     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

ะัะธ ะฟะตัะตะบะปััะตะฝะธะธ ะฝะฐ Production:
1. ะกะพะทะดะฐัััั SSH ััะฝะฝะตะปั ะบ ัะตัะฒะตัั
2. ะะพะบะฐะปัะฝัะน ะฟะพัั 15432 โ PostgreSQL ะฝะฐ ัะตัะฒะตัะต (5432)
3. ะะพะบะฐะปัะฝัะน ะฟะพัั 17017 โ MongoDB ะฝะฐ ัะตัะฒะตัะต (27017)

## ะขัะตะฑะพะฒะฐะฝะธั

- Python 3.8+
- SSH ะบะปัั ะดะปั ะดะพัััะฟะฐ ะบ production ัะตัะฒะตัั (ะดะปั production ัะตะถะธะผะฐ)
- ะะธะฑะปะธะพัะตะบะฐ `sshtunnel` (ะฐะฒัะพะผะฐัะธัะตัะบะธ ัััะฐะฝะฐะฒะปะธะฒะฐะตััั)

## Troubleshooting

### ะัะธะฑะบะฐ "SSH ะบะปัั ะฝะต ะฝะฐะนะดะตะฝ"

ะฃะฑะตะดะธัะตัั, ััะพ ะฟััั ะบ SSH ะบะปััั ะบะพััะตะบัะฝัะน:

```bash
export PROD_SSH_KEY=~/.ssh/your_key
```

### ะัะธะฑะบะฐ ะฟะพะดะบะปััะตะฝะธั ะบ Production

1. ะัะพะฒะตัััะต, ััะพ SSH ะบะปัั ะดะพะฑะฐะฒะปะตะฝ ะบ ัะตัะฒะตัั
2. ะัะพะฒะตัััะต, ััะพ ัะตัะฒะตั ะดะพัััะฟะตะฝ: `ssh yc-user@93.77.182.26`
3. ะัะพะฒะตัััะต ะฟะฐัะพะปะธ ะพั ะฑะฐะท ะดะฐะฝะฝัั

### ะะธะฑะปะธะพัะตะบะฐ sshtunnel ะฝะต ัััะฐะฝะพะฒะปะตะฝะฐ

```bash
pip install sshtunnel
```

## ะกะบัะธะฝัะพัั

### ะะตัะตะบะปััะตะฝะธะต ะพะบััะถะตะฝะธะน
- **Local** โ ะฟะพะดะบะปััะตะฝะธะต ะบ ะปะพะบะฐะปัะฝัะผ Docker ะบะพะฝัะตะนะฝะตัะฐะผ
- **Production** โ ะฟะพะดะบะปััะตะฝะธะต ัะตัะตะท SSH ััะฝะฝะตะปั ะบ Yandex Cloud

### ะัะพัะผะพัั ะดะฐะฝะฝัั
- ะกะฟะธัะพะบ ัะฐะฑะปะธั PostgreSQL ะธ ะบะพะปะปะตะบัะธะน MongoDB
- ะะฝัะพัะผะฐัะธั ะพ ะบะพะปะพะฝะบะฐั ะธ ัะธะฟะฐั ะดะฐะฝะฝัั
- ะะฐะณะธะฝะฐัะธั ะดะปั ะฑะพะปััะธั ัะฐะฑะปะธั
- ะัะพัะผะพัั ะฒะปะพะถะตะฝะฝัั JSON ะพะฑัะตะบัะพะฒ
